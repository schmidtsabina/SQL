
USE Firma
GO
CREATE VIEW vAngajati AS
SELECT A.IdAngajat, A.Nume, A.Prenume,
D.Denumire AS Departament,
F.Denumire AS Functie, F.Salariu, A.
DataNasterii, A.DataAngajarii
FROM Angajati A, Departamente D, Functii F
WHERE A.IdDept=D.IdDept AND A.IdFunctie=F.IdFunctie
GO
SELECT * FROM vAngajati
GO

SELECT Nume, Prenume, Departament
FROM vAngajati
WHERE Departament = 'PROIECTARE' and Nume like '%1%'
ORDER BY Nume, Prenume

SELECT Nume, Prenume, Departament
FROM vAngajati
WHERE Departament = 'PROIECTARE' and Nume like '%2'
ORDER BY Nume, Prenume

SELECT Nume, Prenume,Salariu
FROM vAngajati
WHERE Departament = 'PRODUCTIE'
order by Salariu 

SELECT COUNT(*) NrAng
FROM vAngajati
WHERE Departament = 'PROIECTARE'

select sum(salariu)
FROM vAngajati

SELECT AVG(Salariu) SalMed
FROM vAngajati
WHERE Departament = 'PRODUCTIE'

SELECT FUNCTIE, AVG(Salariu) SalMed
FROM vAngajati
GROUP BY FUNCTIE
ORDER BY SalMed DESC

SELECT MIN(SALARIU)
FROM vAngajati

SELECT MAX(SALARIU)
FROM vAngajati

SELECT MAX(SALARIU)
FROM vAngajati
WHERE DEPARTAMENT='PRODUCTIE'

SELECT DEPARTAMENT, MIN(SALARIU),MAX(SALARIU)
FROM vAngajati
GROUP BY DEPARTAMENT

SELECT DEPARTAMENT, COUNT(*)
FROM vAngajati
GROUP BY DEPARTAMENT

SELECT DEPARTAMENT, SUM(SALARIU)
FROM vAngajati
GROUP BY DEPARTAMENT

SELECT NUME,PRENUME,DEPARTAMENT,DATAANGAJARII
FROM vAngajati
ORDER BY DEPARTAMENT, DATAANGAJARII

SELECT NUME,PRENUME,FUNCTIE
FROM vAngajati
WHERE DATEDIFF(YEAR,GETDATE(),DATAANGAJARII)>10
GROUP BY FUNCTIE 


SELECT NUME,PRENUME,DEPARTAMENT
FROM vAngajati
WHERE DATEDIFF(YEAR,GETDATE(),DATANASTERII)>30
GROUP BY DEPARTAMENT

SELECT DEPARTAMENT 
FROM vAngajati
GROUP BY DEPARTAMENT
HAVING AVG(SALARIU)>3000

SELECT DEPARTAMENT 
FROM vAngajati
WHERE (SELECT AVG(SALARIU) FROM vAngajati )>3000
GROUP BY DEPARTAMENT
